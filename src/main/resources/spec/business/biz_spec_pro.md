# [PRD] 소상공인 재무 시뮬레이션 시스템 상세 설계서 - 전문가 모드 (Expert Mode)

## 1. 기본 환경 설정 (Basic Setup)

모든 재무 계산의 기준점(Baseline)을 정의합니다.

- **업종 선택 (industryCd)**: 1:제조업, 2:소매업, 3:외식업, 4:시설서비스업, 5:용역서비스업
- **매출 계산 모드 (saleMode)**:
  - 1: 일 판매량 기준 (단가 × 수량 × 영업일수)
  - 2: 월 판매량 기준 (단가 × 수량)
- **영업 일수 (workDay)**: 월평균 실제 가동일 (1~31일)
- **월 목표 이익 (monTargetPrice)**: 사업자가 달성하고자 하는 세전 순이익 목표액

## 2. 예상 매출액 계획 (Sales Plan)

메뉴별 판매 데이터를 통해 전체 재무 계획의 기초가 되는 매출액을 산출합니다.

- **계산 로직**:
  - **월 매출액 (S_month)**:
    - 일 판매 기준: `단가 * 일 판매량 * 영업일수`
    - 월 판매 기준: `단가 * 월 판매량`
  - **년 매출액 (S_year)**: `S_month * 12`
- **연도별 매출 확장 (2, 3차년도)**:
  - **증감율 모드 (menuCd=1)**: `menuQtyRate`, `menuPriceRate` 입력 시 판매량과 단가가 자동 계산됨.
  - **직접 입력 모드 (menuCd=2)**: 사용자가 각 연도별 수량과 단가를 직접 수정 가능.
- **시스템 연동**: 합계된 월 매출액은 '매출액 대비 %' 기준의 모든 경비 계산의 모수가 됩니다.

## 3. 재료비 및 매출원가 계획 (COGS Plan)

### 3.1. 재료비 (Variable Costs)

- **메뉴별 재료비율 (costRate, %)**: 각 메뉴별 매출액 대비 원가 비중.
- **연도별 재료비**: `costCd=1`로 설정하며, `costAmtRate` 증감율에 따라 `costRate`와 `costAmt`가 자동 산출됨.

### 3.2. 매출원가 명세서 (Cost of Goods Sold)

- **제조업 (industryCd=1)**:
  - `당기제품제조원가 = 재료비 + 노무비(제조) + 제조경비`
  - `당기매출원가 = 기초재고 + 당기제품제조원가 - 기말재고`
- **비제조업**: `당기매출원가 = 당기상품매입액(재료비)`

## 4. 인건비 계획 (Labor Cost Plan)

- **부문 분류**:
  - **제조부문 (job.production)**: 주방/생산 인력 -> 제조원가(노무비)로 귀속.
  - **판매관리부문 (job.sales)**: 서빙/마케팅 인력 -> 판관비(급여)로 귀속.
- **생산성 지표**:
  - **인건비 비율**: `(연간 인건비 / 연간 매출액) * 100` (목표: 업종별 상이)
  - **1인당 매출액/인건비**: 인력 효율성 판단 지표 (단위: 천원)

## 5. 투자 및 감가상각 계획 (Investment Plan)

투자 항목별로 상각 여부와 기간을 설정하여 월별 비용을 산출합니다.

- **분류**: 유형자산, 무형자산, 기타비유동자산, 기타투자비용.
- **상각 로직**: `investYn = 'Y'`인 경우 `투자금액 / (상각년수 * 12)`를 통해 월 감가상각비 생성.
- **데이터 매핑**: 제조/판매 부문 선택에 따라 `invest.production` 또는 `invest.sales`로 구분 저장. 필드명: `investAmtYear`.

## 6. 자금조달 계획 (Financing Plan)

- **자기자금 (equity)**: 자본금, 출자금 등 (이자 비용 없음).
- **타인자금 (debt)**: 융자 및 차입금.
  - **이자 비용**: `차입금액 * (이자율 / 100)` (소수점 반올림).
  - **이자율 상속**: 1차년도 설정값이 2, 3차년도로 자동 승계되나 개별 수정 가능.

## 7&8. 경비 계획 (Expense Plan: Manufacturing & SGA)

항목별로 4가지 기준 중 하나를 선택하여 자동 계산합니다.

1.  **매출액 대비 %**: `매출합계 * 적용값(%)` -> 카드수수료, 포장비 등. (`expenseTVaCd` = '매출액')
2.  **월정액**: 고정된 금액 입력 -> 임차료, 통신비 등. (`expenseTVaCd` = '월정액')
3.  **인건비 대비 %**: `해당부문 인건비 * 적용값(%)` -> 복리후생비 등. (`expenseTVaCd` = '인건비')
4.  **기준액 대비 %**: `감가상각 대상금액 * 적용값(%)` -> 감가상각비 등. (`expenseTVaCd` = '기준액')

---

## 9. 재무제표 시뮬레이션

### 9.1. 연도별 손익계산서 (P&L)

- **매출총이익**: `매출액 - 매출원가`
- **영업이익**: `매출총이익 - 판매관리비`
- **경상이익**: `영업이익 - 영업외비용(이자)`

### 9.2. 손익분기점 분석 (BEP)

- **변동비**: 재료비 + 매출연동형 경비(제조/판매).
- **고정비**: 인건비 + 월정액 경비 + 이자비용.
- **BEP 매출액**: `고정비 / (한계이익률 / 100)` (`한계이익률 = (매출-변동비)/매출 * 100`).

### 9.3. 재무상태표 (BS)

- **비유동자산**: `총 투자금액 - 누적 감가상각비`.
- **부채**: 타인자금 합계.
- **자본**: 자기자금 + 누적 이익잉여금(경상이익의 합).
- **유동자산**: `(부채 + 자본) - 비유동자산` (회계 등식 기준).

---

## 10. 경영 진단 리포트 (Diagnosis)

업종별 표준 지표와 비교하여 사업의 건강도를 평가합니다.

| 지표명             | 산출 공식              | 검토 기준 (우수)              |
| :----------------- | :--------------------- | :---------------------------- |
| **투자금액회전율** | 매출액 / 총투자금액    | 외식(1.8회), 소매(2.7회) 이상 |
| **매출영업이익률** | 영업이익 / 매출액      | 외식(16.2%), 제조(10%) 이상   |
| **인건비 비율**    | 인건비 / 매출액        | 외식(22%), 제조(15%) 이하     |
| **임차료 비율**    | 월임차료 / 월매출액    | 외식(11%), 소매(8.8%) 이하    |
| **자기자금비율**   | 자기자본 / 총자산      | 전 업종 50% 이상 권장         |
| **손익분기점률**   | BEP매출액 / 실제매출액 | 외식(73.6%), 제조(66%) 이하   |

---

## 11. 수익성 검토 및 가이드

- **분석 요약**: 실제 영업이익과 사용자의 목표 이익을 비교하여 성공 가능성 타진.
- **액션 처방**: 목표 미달 시 **"현재 단가 기준, 하루에 메뉴 N개를 더 판매해야 목표 달성 가능"**과 같은 구체적인 운영 목표 제시.

---

## 12. 전체 데이터 구조 (Reference JSON)

```json
{
  "basic": {
    "industryCd": "3",
    "workDay": 25,
    "monTargetPrice": 5000000,
    "saleMode": "1"
  },
  "sale": {
    "menu": [
      { "menuTitle": "A제품(제조)", "menuPrice": 20000, "menuQty": 30 },
      { "menuTitle": "B제품(제조)", "menuPrice": 7000, "menuQty": 40 },
      { "menuTitle": "C소모품(유통)", "menuPrice": 3000, "menuQty": 50 },
      { "menuTitle": "D소모품(유통)", "menuPrice": 1000, "menuQty": 50 }
    ],
    "menuM": [
      {
        "menuQty": [750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750, 750],
        "menuAmt": [
          15000000, 15000000, 15000000, 15000000, 15000000, 15000000, 15000000,
          15000000, 15000000, 15000000, 15000000, 15000000
        ]
      },
      {
        "menuQty": [
          1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000
        ],
        "menuAmt": [
          7000000, 7000000, 7000000, 7000000, 7000000, 7000000, 7000000,
          7000000, 7000000, 7000000, 7000000, 7000000
        ]
      }
    ],
    "menuY": [
      {
        "menuQty": [9000, 9000, 9000],
        "menuPrice": [20000, 20000, 20000],
        "menuAmt": [180000000, 180000000, 180000000],
        "menuCd": "1",
        "menuQtyRate": 0,
        "menuPriceRate": 0
      }
    ]
  },
  "cost": {
    "costRate": [40, 40, 30, 30],
    "costM": [
      {
        "costAmt": [
          6000000, 6000000, 6000000, 6000000, 6000000, 6000000, 6000000,
          6000000, 6000000, 6000000, 6000000, 6000000
        ]
      }
    ],
    "costY": [
      {
        "costAmt": [72000000, 72000000, 72000000],
        "costRate": [40, 40, 40],
        "costCd": "1",
        "costAmtRate": 0
      }
    ]
  },
  "job": {
    "production": [
      {
        "jobTitle": "생산직 관리",
        "jobCnt": "1",
        "jobQty": 3000000,
        "jobAmt": [
          3000000, 3000000, 3000000, 3000000, 3000000, 3000000, 3000000,
          3000000, 3000000, 3000000, 3000000, 3000000
        ],
        "jobAmtYear": [36000000, 36000000, 36000000],
        "jobAmtCd": "1",
        "jobAmtRate": 0
      }
    ],
    "sales": [
      {
        "jobTitle": "매장영업",
        "jobCnt": "1",
        "jobQty": 1500000,
        "jobAmt": [
          1500000, 1500000, 1500000, 1500000, 1500000, 1500000, 1500000,
          1500000, 1500000, 1500000, 1500000, 1500000
        ],
        "jobAmtYear": [18000000, 18000000, 18000000],
        "jobAmtCd": "1",
        "jobAmtRate": 0
      }
    ]
  },
  "invest": {
    "production": {
      "production01": [
        {
          "investTitle": "제조설비공사",
          "investTitleCd": "30",
          "investPrice": 40000000,
          "investYear": 5,
          "investAmtYear": 667000,
          "investYn": "Y"
        }
      ],
      "production02": [],
      "production03": [],
      "production04": []
    },
    "sales": {
      "sales01": [
        {
          "investTitle": "인테리어비용",
          "investTitleCd": "60",
          "investPrice": 16000000,
          "investYear": 5,
          "investAmtYear": 267000,
          "investYn": "Y"
        }
      ],
      "sales02": [
        {
          "investTitle": "보증금/권리금",
          "investTitleCd": "10",
          "investPrice": 100000000,
          "investAmtYear": 0,
          "investYn": "N"
        }
      ],
      "sales03": [],
      "sales04": []
    }
  },
  "loan": {
    "equity": [
      { "loanTitle": "자본금", "loanTitleCd": "10", "loanAmtYear": [100000000] }
    ],
    "debt": [
      {
        "loanTitle": "소상공인융자",
        "loanTitleCd": "10",
        "loanAmtYear": [50000000, 0, 0],
        "loanRate": [3.0, 3.0, 3.0],
        "loanRateAmtYear": [1500000, 1500000, 1500000]
      }
    ]
  },
  "expense": {
    "production": [
      {
        "expenseTitle": "공장전력비",
        "expenseTVaAmt": 2700000,
        "expenseTVa": 3.5,
        "expenseTVaCd": "매출액",
        "expenseAmt": [
          2700000, 2700000, 2700000, 2700000, 2700000, 2700000, 2700000,
          2700000, 2700000, 2700000, 2700000, 2700000
        ],
        "expenseAmtYear": [32400000, 32400000, 32400000]
      }
    ],
    "sales": [
      {
        "expenseTitle": "지급임차료",
        "expenseTVaAmt": 2700000,
        "expenseTVa": 3.5,
        "expenseTVaCd": "매출액",
        "expenseAmt": [
          2700000, 2700000, 2700000, 2700000, 2700000, 2700000, 2700000,
          2700000, 2700000, 2700000, 2700000, 2700000
        ],
        "expenseAmtYear": [32400000, 32400000, 32400000]
      }
    ]
  },
  "cogs": {
    "title": "매출원가 분석 (통합)",
    "beginningInv": [0, 2000000, 2500000],
    "endingInv": [2000000, 2500000, 3000000],
    "currentPeriodCost": [140400000, 140400000, 140400000],
    "totalCogs": [138400000, 139900000, 139900000],
    "sourceMapping": {
      "materials": "cost.costY[0].costAmt",
      "labor": "job.production[0].jobAmtYear",
      "overhead": "expense.production[0].expenseAmtYear"
    }
  },
  "summary": {
    "opIncome": 4605000,
    "bepRevenue": 20385000,
    "ordAmtYear": [53160000, 53160000, 53160000],
    "totalRevenue": 27000000
  }
}
```
