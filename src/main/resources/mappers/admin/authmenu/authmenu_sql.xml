<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.whomade.planfAi.admin.authmenu.mapper.AuthMenuMapper">

	<select id="selectTotCntAuthor" parameterType="dataMap" resultType="int">
	/* com.whomade.planfAi.admin.authmenu.mapper.AuthMenuMapper.selectTotCntAuthor */
	SELECT COUNT(1) TOT_CNT
	FROM op_author A
	WHERE 1 = 1
	<if test="schAuthNm != null and schAuthNm != ''">
	AND   A.AUTHOR_NM LIKE CONCAT('%', #{schAuthNm}, '%')
	</if>
	</select>

	<select id="selectPageListAuthor" parameterType="dataMap" resultType="dataMap">
	/* com.whomade.planfAi.admin.authmenu.mapper.AuthMenuMapper.selectPageListAuthor */
	SELECT A.AUTHOR_ID
		, A.AUTHOR_NM
		, A.RM
		, A.REGISTER_NO
		, DATE_FORMAT(A.REGIST_DT, '%Y.%m.%d') AS REGIST_YMD
		, B.USER_NM
		, A.REGIST_DT
	FROM op_author A
	LEFT OUTER JOIN op_user B
	ON A.REGISTER_NO = B.USER_NO
	WHERE 1 = 1
	<if test="schAuthNm != null and schAuthNm != ''">
		AND A.AUTHOR_NM LIKE CONCAT('%', #{schAuthNm}, '%')
	</if>
	ORDER BY A.AUTHOR_NM ASC
	</select>

	<select id="selectAuthorInfo" parameterType="string" resultType="dataMap">
	/* com.whomade.planfAi.admin.authmenu.mapper.AuthMenuMapper.selectAuthorInfo */
	SELECT AUTHOR_ID, AUTHOR_NM
	FROM op_author
	WHERE AUTHOR_ID = #{authorId}
	</select>

	<select id="selectListAuthMenu" parameterType="string" resultType="com.whomade.planfAi.admin.authmenu.vo.AuthMenuVo">
	/* com.whomade.planfAi.admin.authmenu.mapper.AuthMenuMapper.selectListAuthMenu */
	SELECT
		  A.MENU_ID,
          A.MENU_TY_CODE,
          A.MENU_LEVEL,
          A.MENU_NM,
          A.URL,
          A.SORT_ORDR,
          A.USE_YN,
          A.SORT_ORDR_1,
          A.SORT_ORDR_2,
          A.SORT_ORDR_3,
          A.SORT_ORDR_4,
          A.SORT_ORDR_5,
          A.SORT_ORDR_6
          ,CASE WHEN IFNULL(B.MENU_ID,'') = '' THEN 'N' ELSE 'Y' END AUTH_YN
		FROM op_menu A
        LEFT OUTER JOIN op_author_menu B
            ON A.MENU_ID = B.MENU_ID
            AND B.AUTHOR_ID = #{authorId}
        ORDER BY A.MENU_ID ASC
	</select>

	<insert id="insertAuthMenu" parameterType="com.whomade.planfAi.admin.authmenu.vo.AuthMenuVo">
	/* com.whomade.planfAi.admin.authmenu.mapper.AuthMenuMapper.insertAuthMenu */
	INSERT INTO op_author_menu(AUTHOR_ID
		, MENU_ID
		, REGISTER_NO
		, REGIST_DT
	) VALUES (
		#{authorId}
		, #{menuId}
		, #{registerNo}
		, CURRENT_TIMESTAMP
	)
	</insert>

	<delete id="deleteAuthMenu" parameterType="string">
	/* com.whomade.planfAi.admin.authmenu.mapper.AuthMenuMapper.deleteAuthMenu */
	DELETE
	FROM op_author_menu
	WHERE AUTHOR_ID = #{authorId}
	</delete>

</mapper>
